# Production Deployment: Complete Setup Guide

**Recommended Approach**: Vercel Frontend + Railway Backend + Railway Database

This is the fastest, most reliable setup for production.

## üéØ What You'll Deploy

| Component | Platform | Cost |
|-----------|----------|------|
| React Frontend | Vercel | Free |
| Node.js Backend API | Railway | Free tier ($5 credit) |
| MySQL Database | Railway | Free tier ($5 credit) |

## ‚è±Ô∏è Time Required: ~15 minutes

## Step 1: Create Railway Accounts & Services

### 1a. Create MySQL Database
1. Go to https://railway.app
2. Sign in with GitHub
3. New Project
4. Click "Provision New" ‚Üí "Database" ‚Üí "MySQL"
5. Wait 1-2 minutes for provisioning
6. Click MySQL card ‚Üí "Connect" tab
7. **Copy these values:**
   ```
   MYSQL_HOST=container-xxx.railway.app
   MYSQL_PORT=6543
   MYSQL_USER=root
   MYSQL_PASSWORD=AutoGenerated...
   MYSQL_DB=railway
   ```

### 1b. Save Database Credentials
Create file: `.env.railway` with values above:
```bash
DB_HOST=container-xxx.railway.app
DB_PORT=6543
DB_NAME=railway
DB_USER=root
DB_PASS=your-password-here
```

### 1c. Import Your Data (Optional)
If you have existing FarmSuite data:

```bash
# Step 1: Export from local MySQL
/opt/lampp/bin/mysqldump -u root --socket=/opt/lampp/var/mysql/mysql.sock farmsuite > backup.sql

# Step 2: Import to Railway
./import-railway.sh backup.sql
```

## Step 2: Deploy Backend to Railway

### 2a. Create Backend Service
1. In Railway dashboard, click "Provision New"
2. Select "Service" ‚Üí "Connect GitHub"
3. Choose `jacobphiri/farmsuite` repo
4. Continue
5. Set these options:
   - **Root Directory**: `ReactNative`
   - **Build Command**: `npm install`
   - **Start Command**: `npm run start`

### 2b. Configure Environment Variables
In Railway, go to Variables tab and add:

```
DB_HOST=container-xxx.railway.app
DB_PORT=6543
DB_NAME=railway
DB_USER=root
DB_PASS=your-password-from-above
DB_SOCKET=

JWT_SECRET=your-random-32-character-secret-key
JWT_EXPIRES_IN=12h

CACHE_TTL_SECONDS=45
LOCAL_DB_PATH=server/data/farmreact_local_cache.sqlite
```

### 2c. Generate JWT Secret
Run this command locally and copy output:
```bash
node -e "console.log(require('crypto').randomBytes(32).toString('hex'))"
```
Paste the output as `JWT_SECRET` in Railway

### 2d. Deploy
1. Click **Deploy**
2. Wait 3-5 minutes for deployment
3. Go to "Deployments" tab
4. Copy the deployment URL (e.g., `https://your-app.up.railway.app`)

## Step 3: Deploy Frontend to Vercel

### 3a. Go to Vercel
1. https://vercel.com
2. Sign in with GitHub

### 3b. Import Project
1. Click "Add New" ‚Üí "Project"
2. Import `jacobphiri/farmsuite` repo
3. Continue
4. Set **Root Directory**: `ReactNative`
5. Framework auto-detects: **Vite**

### 3c. Configure Build Settings
Leave as default or set explicitly:
- **Build Command**: `npm --prefix client run build`
- **Output Directory**: `client/dist`
- **Install Command**: `npm install`

### 3d. Add Environment Variables
Add ONE variable before deploying:

| Name | Value |
|------|-------|
| `VITE_API_URL` | `https://your-railway-backend.up.railway.app` |

(Use the Railway URL from Step 2d)

### 3e. Deploy
1. Click **Deploy**
2. Wait 3-5 minutes for deployment
3. Get your Vercel URL (e.g., `https://farmsuite.vercel.app`)

## Step 4: Test Your App

1. Open your Vercel URL
2. Test login (create test account)
3. Try basic operations:
   - Navigate to different modules
   - Create a record
   - Check if data persists

## Step 5: Enable Auto-Deployment

Both Vercel and Railway automatically redeploy when you push to GitHub:

```bash
cd /opt/lampp/htdocs/farmsuite
git commit -am "Production setup complete"
git push origin main
```

Changes are automatically deployed!

## üîó Your Production URLs

After deployment, you'll have:

```
Frontend: https://farmsuite.vercel.app
Backend API: https://your-app.up.railway.app
Database: Railway MySQL (internal connection)
```

## ‚úÖ Deployment Checklist

- [ ] Railway MySQL database created
- [ ] Railway backend service deployed
- [ ] Backend URL copied and working
- [ ] Vercel frontend deployed
- [ ] Frontend VITE_API_URL environment variable set
- [ ] Both services showing "Deployed" status
- [ ] Frontend loads without errors
- [ ] Login works in production
- [ ] Can create/read/update records
- [ ] Data appears in Railway MySQL

## üìä Current Status

| Step | Status | Command |
|------|--------|---------|
| 1. Database | ‚è≥ TODO | Create Railway MySQL |
| 2. Backend | ‚è≥ TODO | Deploy to Railway |
| 3. Frontend | ‚è≥ TODO | Deploy to Vercel |
| 4. Test | ‚è≥ TODO | Visit Vercel URL |

## üÜò Troubleshooting

### Frontend shows "Cannot reach API"
- Check Railway backend deployment status
- Verify VITE_API_URL in Vercel env vars
- Check browser console (F12) for actual error

### Backend returns 500 error
- Check Railway function logs
- Verify database credentials
- Check database is still running in Railway

### Login doesn't work
- Check JWT_SECRET is set in Railway
- Verify database exported correctly
- Check users table has data

### "Build failed" on Vercel
- Check build logs in Vercel dashboard
- Run locally: `npm run build`
- Fix any errors before pushing

## üí∞ Costs

**Vercel Free Tier**:
- 100 deploys/month
- 50 projects
- Production-ready
- **Cost**: $0

**Railway Free Tier**:
- $5/month credit
- Covers most small apps
- Additional usage: $0.07/GB billed monthly
- **Cost**: $0-5/month

**Total**: $0-5/month for production app!

## üöÄ Advanced: Custom Domain

### Vercel Custom Domain
1. Vercel dashboard ‚Üí Project settings
2. Domains ‚Üí Add
3. Connect your domain
4. Configure DNS (Vercel provides instructions)

### Railway Custom Domain
1. Railway dashboard ‚Üí Database (or service)
2. Settings ‚Üí Custom domains
3. Add domain

## üìû Support

If something goes wrong:
1. Check logs in dashboard
2. Verify env variables are set
3. Check DATABASE_MIGRATION.md troubleshooting
4. Review SETUP_COMPLETE.md for background

---

**You're ready to go live!** Follow these steps in order and your app will be on the internet in 15 minutes. üöÄ
